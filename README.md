# `coqffi`

```ocaml
open Coqbase

type fd

val openfile : Bytestring.t -> fd
val read_all : fd -> Bytestring.t
val write : fd -> Bytestring.t -> unit
val closefile : fd -> unit

val fd_equal : fd -> fd -> bool [@@ffi_pure]

val swap : ('a -> 'b -> 'c) -> 'b -> 'a -> 'c [@@ffi_pure]
```

```coq
(* This file has been generated by coqffi. *)

From FreeSpec.Core Require Import All.

Set Implicit Arguments.

Axiom (fd : Type).

Axiom (swap : forall (a : Type) (b : Type) (c : Type), (a -> (b -> c)) -> (b -> a) -> c).
Axiom (fd_equal : fd -> fd -> bool).

Inductive FILE : interface :=
| Closefile : fd -> FILE unit
| Write : fd -> Base.Data.Bytestring.bytestring -> FILE unit
| Read_all : fd -> FILE Base.Data.Bytestring.bytestring
| Openfile : Base.Data.Bytestring.bytestring -> FILE fd.

Definition closefile `{Provide ix FILE} (arg0 : fd) : impure ix unit :=  request (Closefile arg0).
Definition write `{Provide ix FILE} (arg0 : fd) (arg1 : Base.Data.Bytestring.bytestring) : impure ix unit :=  request (Write arg0 arg1).
Definition read_all `{Provide ix FILE} (arg0 : fd) : impure ix Base.Data.Bytestring.bytestring :=  request (Read_all arg0).
Definition openfile `{Provide ix FILE} (arg0 : Base.Data.Bytestring.bytestring) : impure ix fd :=  request (Openfile arg0).

Module FileExtr.
  Axiom (ocaml_closefile : fd -> unit).
  Extract Constant ocaml_closefile => "Demo.File.closefile".
  Axiom (ocaml_write : fd -> Base.Data.Bytestring.bytestring -> unit).
  Extract Constant ocaml_write => "Demo.File.write".
  Axiom (ocaml_read_all : fd -> Base.Data.Bytestring.bytestring).
  Extract Constant ocaml_read_all => "Demo.File.read_all".
  Axiom (ocaml_openfile : Base.Data.Bytestring.bytestring -> fd).
  Extract Constant ocaml_openfile => "Demo.File.openfile".

  Definition file : semantics FILE :=
    bootstrap (fun a e =>
                 local match e in FILE a return a with
                 | Closefile arg0 => ocaml_closefile arg0
                 | Write arg0 arg1 => ocaml_write arg0 arg1
                 | Read_all arg0 => ocaml_read_all arg0
                 | Openfile arg0 => ocaml_openfile arg0
                 end).

  Extract Constant swap => "Demo.File.swap".
  Extract Constant fd_equal => "Demo.File.fd_equal".
End FileExtr.
```
